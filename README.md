# æ™ºèƒ½è¯„è®ºå›å¤ Agent

è¿™æ˜¯ä¸€ä¸ªåŸºäº LangChain å’Œ LangGraph æ„å»ºçš„æ™ºèƒ½å®¢æœé¡¹ç›®ï¼Œæ—¨åœ¨è‡ªåŠ¨åˆ†æç”µå•†å¹³å°ä¸Šçš„ç”¨æˆ·è¯„è®ºï¼Œå¹¶æ ¹æ®è¯„è®ºå†…å®¹ç”Ÿæˆé«˜åº¦å®šåˆ¶åŒ–çš„å›å¤ã€‚

## âœ¨ é¡¹ç›®ç‰¹è‰²

- **æ™ºèƒ½åˆ†è¯Š**: è‡ªåŠ¨åˆ†æè¯„è®ºçš„æƒ…æ„Ÿï¼ˆæ­£é¢/è´Ÿé¢/ä¸­æ€§ï¼‰å’Œæœ‰æ•ˆæ€§ï¼ˆçœŸå®è¯„è®º/é»˜è®¤å¥½è¯„ï¼‰ã€‚
- **åŠ¨æ€è·¯ç”±**: ä½¿ç”¨ LangGraph çš„æ¡ä»¶è·¯ç”±ï¼Œå°†ä¸åŒç±»å‹çš„è¯„è®ºåˆ†å‘ç»™ä¸åŒçš„å¤„ç†é€»è¾‘ã€‚
- **RAG å¢å¼º**: å¯¹äºæåŠâ€œäº§å“ä¸ä¼šç”¨â€çš„è´Ÿé¢è¯„è®ºï¼Œèƒ½è‡ªåŠ¨ä»æœ¬åœ°çš„ PDF è¯´æ˜ä¹¦ (`ES.pdf`) ä¸­æ£€ç´¢ç›¸å…³ä¿¡æ¯ï¼Œå¹¶æ•´åˆåˆ°å›å¤ä¸­ã€‚
- **å·¥å…·è°ƒç”¨**: åœ¨è´Ÿé¢è¯„è®ºå¤„ç†æµç¨‹ä¸­ï¼ŒAgent è¢«æˆæƒå¯ä»¥è‡ªä¸»å†³å®šæ˜¯å¦è°ƒç”¨ `read_instructions` å·¥å…·æ¥æŸ¥è¯¢çŸ¥è¯†åº“ã€‚
- **æ¨¡å—åŒ–è®¾è®¡**: ä»£ç ç»“æ„æ¸…æ™°ï¼Œåˆ†ä¸ºé…ç½®ã€RAG è®¾ç½®ã€å›¾å·¥ä½œæµå’Œä¸»å…¥å£ï¼Œæ˜“äºç»´æŠ¤å’Œæ‰©å±•ã€‚

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

- **æ ¸å¿ƒæ¡†æ¶**: LangChain, LangGraph
- **å¤§è¯­è¨€æ¨¡å‹ (LLM)**: DeepSeek API
- **åµŒå…¥æ¨¡å‹ (Embedding)**: é˜¿é‡Œå·´å·´é€šä¹‰åƒé—® (DashScope)
- **å‘é‡æ•°æ®åº“**: FAISS (æœ¬åœ°)
- **æ•°æ®æ¨¡å‹**: Pydantic
- **ç¯å¢ƒç®¡ç†**: python-dotenv

## ğŸ“‚ é¡¹ç›®ç»“æ„

```
.
â”œâ”€â”€ agent/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ config.py           # é…ç½®æ–‡ä»¶ (APIå¯†é’¥, è·¯å¾„, æ¨¡å‹åç§°)
â”‚   â”œâ”€â”€ rag_setup.py        # RAGè®¾ç½® (åŠ è½½PDF, åˆ›å»ºå‘é‡åº“, å®šä¹‰å·¥å…·)
â”‚   â”œâ”€â”€ graph_workflow.py   # æ ¸å¿ƒå·¥ä½œæµ (å®šä¹‰çŠ¶æ€, èŠ‚ç‚¹, æ„å»ºå›¾)
â”‚   â””â”€â”€ main.py             # é¡¹ç›®å…¥å£
â”œâ”€â”€ .env                    # (éœ€è¦æ‰‹åŠ¨åˆ›å»º) å­˜æ”¾APIå¯†é’¥
â”œâ”€â”€ .gitignore              # Gitå¿½ç•¥æ–‡ä»¶
â”œâ”€â”€ ES.pdf                  # äº§å“è¯´æ˜ä¹¦çŸ¥è¯†åº“
â”œâ”€â”€ requirements.txt        # é¡¹ç›®ä¾èµ–
â””â”€â”€ README.md               # é¡¹ç›®è¯´æ˜
```

## ğŸš€ å®‰è£…ä¸é…ç½®

1.  **å…‹éš†é¡¹ç›®**
    ```bash
    git clone https://github.com/your-username/your-repo-name.git
    cd your-repo-name
    ```

2.  **å®‰è£…ä¾èµ–**
    å»ºè®®æ‚¨å…ˆåˆ›å»ºä¸€ä¸ªè™šæ‹Ÿç¯å¢ƒã€‚ç„¶åè¿è¡Œä»¥ä¸‹å‘½ä»¤å®‰è£…æ‰€æœ‰å¿…éœ€çš„åº“ï¼š
    ```bash
    pip install -r requirements.txt
    ```
    *å¦‚æœ `requirements.txt` æ–‡ä»¶ä¸å­˜åœ¨ï¼Œæ‚¨å¯ä»¥é€šè¿‡ `pip freeze > requirements.txt` å‘½ä»¤ç”Ÿæˆã€‚*
    ä¸»è¦ä¾èµ–åŒ…æ‹¬: `langchain`, `langgraph`, `faiss-cpu`, `pydantic`, `python-dotenv`, `langchain-community`, `pypdf`, `dashscope`ã€‚

3.  **é…ç½®APIå¯†é’¥**
    åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹ï¼Œåˆ›å»ºä¸€ä¸ªåä¸º `.env` çš„æ–‡ä»¶ã€‚è¿™ä¸ªæ–‡ä»¶ç”¨äºå­˜æ”¾æ‚¨çš„ç§å¯†ä¿¡æ¯ï¼Œä¸ä¼šè¢«ä¸Šä¼ åˆ° GitHubã€‚
    ```
    # .env æ–‡ä»¶å†…å®¹
    DEEPSEEK_API_KEY="sk-..."
    DASHSCOPE_API_KEY="sk-..."
    ```

4.  **å‡†å¤‡çŸ¥è¯†åº“**
    å°†æ‚¨çš„äº§å“è¯´æ˜ä¹¦ PDF æ–‡ä»¶å‘½åä¸º `ES.pdf` å¹¶æ”¾ç½®åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹ã€‚

## ğŸƒ å¦‚ä½•è¿è¡Œ

1.  **é¦–æ¬¡è¿è¡Œ**:
    é¦–æ¬¡è¿è¡Œæ—¶ï¼Œç¨‹åºä¼šè‡ªåŠ¨è¯»å– `ES.pdf` æ–‡ä»¶ï¼Œåˆ›å»ºå‘é‡ç´¢å¼•å¹¶ä¿å­˜åœ¨ `emb/` æ–‡ä»¶å¤¹ä¸‹ã€‚è¿™ä¸ªè¿‡ç¨‹å¯èƒ½éœ€è¦ä¸€äº›æ—¶é—´ã€‚

2.  **æ‰§è¡Œå‘½ä»¤**:
    åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹æ‰“å¼€ç»ˆç«¯ï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š
    ```bash
    python agent/main.py
    ```
    ç¨‹åºå°†æ‰§è¡Œ `main.py` ä¸­é¢„è®¾çš„å‡ ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼Œå¹¶æ‰“å°å‡º Agent çš„å®Œæ•´æ€è€ƒæµç¨‹å’Œæœ€ç»ˆå›å¤ã€‚

## ğŸ§  å·¥ä½œæµç¨‹

Agent çš„å·¥ä½œæµç¨‹è¢«æ„å»ºä¸ºä¸€ä¸ªçŠ¶æ€å›¾ (State Graph):

1.  **å…¥å£ (START)**: æ¥æ”¶åŸå§‹çš„ç”¨æˆ·è¯„è®ºå­—ç¬¦ä¸²ã€‚

2.  **åˆ†æèŠ‚ç‚¹ (`analyze_review`)**:
    - è°ƒç”¨ä¸€ä¸ªé…ç½®äº†ç»“æ„åŒ–è¾“å‡ºçš„ LLMã€‚
    - å°†åŸå§‹è¯„è®ºè§£æä¸ºä¸€ä¸ªåŒ…å« `quality`, `emotion`, `key_information` çš„å¯¹è±¡ã€‚

3.  **æ¡ä»¶è·¯ç”± (`route_after_analysis`)**:
    - æ£€æŸ¥åˆ†æç»“æœã€‚
    - **å¦‚æœ** è¯„è®ºæ˜¯æ— æ•ˆçš„ (`default`) -> è·³è½¬åˆ° `generate_default_reply`ã€‚
    - **å¦‚æœ** è¯„è®ºæ˜¯è´Ÿé¢çš„ (`è´Ÿé¢`) -> è·³è½¬åˆ° `generate_negative_reply`ã€‚
    - **å¦åˆ™** (æ­£é¢/ä¸­æ€§) -> è·³è½¬åˆ° `generate_positive_reply`ã€‚

4.  **ç”ŸæˆèŠ‚ç‚¹**:
    - **`generate_positive_reply` / `generate_default_reply`**: è¿”å›é¢„è®¾çš„æ¨¡æ¿åŒ–å›å¤ã€‚
    - **`generate_negative_reply`**: å¯åŠ¨ä¸€ä¸ªå…·å¤‡å·¥å…·è°ƒç”¨èƒ½åŠ›çš„å­ Agentã€‚è¿™ä¸ª Agent ä¼šæ ¹æ®æ”¶åˆ°çš„æŒ‡ä»¤ï¼Œè‡ªä¸»åˆ¤æ–­æ˜¯å¦éœ€è¦è°ƒç”¨ `read_instructions` å·¥å…·æ¥æŸ¥è¯¢è¯´æ˜ä¹¦ï¼Œç„¶åç”ŸæˆåŒ…å«è§£å†³æ–¹æ¡ˆçš„ã€å®‰æŠšæ€§çš„å›å¤ã€‚

5.  **ç»ˆç‚¹ (END)**: è¾“å‡ºæœ€ç»ˆç”Ÿæˆçš„å›å¤å†…
